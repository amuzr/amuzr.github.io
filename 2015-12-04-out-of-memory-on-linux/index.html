<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.13.33"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="canonical" href="https://monthlycode.dev/2015-12-04-out-of-memory-on-linux/" data-baseprotocol="https:" data-basehost="monthlycode.dev"/><title data-react-helmet="true"></title><link data-react-helmet="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nanum+Myeongjo"/><link data-react-helmet="true" rel="icon" href="/static/favicon-36e47e74810a0d8c32a77f495c49cf8e.ico" type="image/x-icon"/><meta data-react-helmet="true" name="description" content="해당 방법은 http://cafe.naver.com/opensourcesw/583 에서 확인한 글입니다. 메모리관련 메커니즘을 수정해서 out of memory 를 줄이는 방법입니다.
Linux의 메모리 관리에서는 메모리 오버커밋이라는 메커니즘이 적…"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  window.excludeGAPaths=[/^(?:\/preview\/(?:(?!(?:\/|^)\.).)*?)$/];
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='UA-XXXX-Y',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-XXXX-Y', 'auto', {"sampleRate":100,"siteSpeedSampleRate":10});
      ga('set', 'anonymizeIp', true);
      
      
      }
      </script><link as="script" rel="preload" href="/1-0bf54a0d9660ab00f8dd.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-69db3bf3742cbe76dea0.js"/><link as="script" rel="preload" href="/0-d4ec043f7f8cf96fd5a5.js"/><link as="script" rel="preload" href="/app-d696c0e2c111e03cf16b.js"/><link as="script" rel="preload" href="/webpack-runtime-03657e977ad153c2e41d.js"/><link as="fetch" rel="preload" href="/page-data/2015-12-04-out-of-memory-on-linux/page-data.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="post-template"><style data-emotion-css="nhb1bn">html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline;}body{line-height:1;}ol,ul{list-style:none;}blockquote,q{quotes:none;}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none;}table{border-spacing:0;border-collapse:collapse;}img{max-width:100%;}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;}*,*:before,*:after{box-sizing:inherit;}a{background-color:transparent;}a:active,a:hover{outline:0;}b,strong{font-weight:bold;}i,em,dfn{font-style:italic;}h1{margin:0.67em 0;font-size:2em;}small{font-size:80%;}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline;}sup{top:-0.5em;}sub{bottom:-0.25em;}img{border:0;}svg:not(:root){overflow:hidden;}mark{background-color:#fdffb6;}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em;}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit;}button{overflow:visible;border:none;}button,select{text-transform:none;}button,html input[type='button'],input[type='reset'],input[type='submit']{cursor:pointer;-webkit-appearance:button;}button[disabled],html input[disabled]{cursor:default;}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0;}input{line-height:normal;}input:focus{outline:none;}input[type='checkbox'],input[type='radio']{box-sizing:border-box;padding:0;}input[type='number']::-webkit-inner-spin-button,input[type='number']::-webkit-outer-spin-button{height:auto;}input[type='search']{box-sizing:content-box;-webkit-appearance:textfield;}input[type='search']::-webkit-search-cancel-button,input[type='search']::-webkit-search-decoration{-webkit-appearance:none;}legend{padding:0;border:0;}textarea{overflow:auto;}table{border-spacing:0;border-collapse:collapse;}td,th{padding:0;}html{overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch;font-size:62.5%;-webkit-tap-highlight-color:rgba(0,0,0,0);}body{overflow-x:hidden;color:#3b474d;font-family:'Nanum Myeongjo',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-size:1.5rem;line-height:1.6em;font-weight:400;font-style:normal;-webkit-letter-spacing:0;-moz-letter-spacing:0;-ms-letter-spacing:0;letter-spacing:0;text-rendering:optimizeLegibility;background:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:'liga' on;}::selection{text-shadow:none;background:#cbeafb;}hr{position:relative;display:block;width:100%;margin:2.5em 0 3.5em;padding:0;height:1px;border:0;border-top:1px solid #e4eaed;}audio,canvas,iframe,img,svg,video{vertical-align:middle;}fieldset{margin:0;padding:0;border:0;}textarea{resize:vertical;}p,ul,ol,dl,blockquote{margin:0 0 1.5em 0;}ol,ul{padding-left:1.3em;padding-right:1.5em;}ol ol,ul ul,ul ol,ol ul{margin:0.5em 0 1em;}ul{list-style:disc;}ol{list-style:decimal;}ul,ol{max-width:100%;}li{margin:0.5em 0;padding-left:0.3em;line-height:1.6em;}dt{float:left;margin:0 20px 0 0;width:120px;color:#15171A;font-weight:500;text-align:right;}dd{margin:0 0 5px 0;text-align:left;}blockquote{margin:1.5em 0;padding:0 1.6em 0 1.6em;border-left:#e5eff5 0.5em solid;}blockquote p{margin:0.8em 0;font-size:1.2em;font-weight:300;}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;font-size:0.9em;opacity:0.8;}blockquote small:before{content:'\2014 \00A0';}blockquote cite{font-weight:bold;}blockquote cite a{font-weight:normal;}a{color:rgba(0,0,0,0.84);-webkit-text-decoration:none;text-decoration:none;-webkit-transition:all 0.4s ease-in-out;transition:all 0.4s ease-in-out;}h1,h2,h3,h4,h5,h6{margin-top:0;line-height:1.15;font-weight:700;text-rendering:optimizeLegibility;}h1{margin:0 0 0.5em 0;font-size:3rem;font-weight:700;}@media (max-width:500px){h1{font-size:1.8rem;}}h2{margin:1.5em 0 0.5em 0;font-size:1.8rem;}@media (max-width:500px){h2{font-size:1.5rem;}}h3{margin:1.5em 0 0.5em 0;font-size:1.5rem;font-weight:500;}@media (max-width:500px){h3{font-size:1.2rem;}}h4{margin:1.5em 0 0.5em 0;font-size:1.3rem;font-weight:500;}h5{margin:1.5em 0 0.5em 0;font-size:1.2rem;font-weight:500;}h6{margin:1.5em 0 0.5em 0;font-size:1.1rem;font-weight:500;}</style><style data-emotion-css="29506a">.css-29506a{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100vh;margin:0 auto;max-width:900px;padding:0 2em;}@media (max-width:500px){.css-29506a .wrapper_minimal{padding:0 4vw;}}</style><div class="css-29506a e1izde070"><style data-emotion-css="nat91l">.css-nat91l{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;margin-bottom:4rem;padding:1.2rem 0 2rem;width:100%;}@media (max-width:500px){.css-nat91l{margin-bottom:0.2rem;}}</style><header role="banner" class="css-nat91l"><style data-emotion-css="1q2sgsz">.css-1q2sgsz{font-size:2rem;font-weight:bold;margin:0;}.css-1q2sgsz a{color:#1c2437;}</style><h1 class="css-1q2sgsz e14r5fw90"><a title="Monthly Code" href="https://monthlycode.dev">Monthly Code</a></h1><style data-emotion-css="195layk">.css-195layk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-left:auto;width:auto;}</style><nav role="navigation" class="css-195layk e14r5fw91"><style data-emotion-css="vpapqp">.css-vpapqp{margin-left:2.1rem;font-family:'Nanum Myeongjo','Open Sans',sans-serif;font-size:1.5rem;line-height:1.6;padding:0;color:rgba(0,0,0,0.7);}@media (max-width:500px){.css-vpapqp{margin-left:1.2rem;}}.css-vpapqp:hover{-webkit-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out;box-shadow:0 2px 0 #2b2b2b;}</style><a class="css-vpapqp" href="/">Posts</a><a class="css-vpapqp" href="/about">About</a></nav></header><style data-emotion-css="1vd0ggw">.css-1vd0ggw{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><main role="main" class="css-1vd0ggw"><article role="article" class="css-0 e109tmbb0"><header><style data-emotion-css="nqbch0">.css-nqbch0{font-size:2.4rem;font-weight:bold;margin:0;}@media (max-width:500px){.css-nqbch0{font-size:1.6rem;}}</style><h1 class="css-nqbch0 e109tmbb1">/etc/messages 에서 out of memory 가 일어나서 프로세스가 종료될 때</h1><style data-emotion-css="1odixc0">.css-1odixc0{display:block;font-family:'Avenir';font-size:0.8rem;color:rgba(0,0,0,0.58);}</style><time dateTime="2015-12-04 16:51:36 +0900" class="css-1odixc0 e109tmbb2">2015 December 4</time></header><style data-emotion-css="mvlhke">.css-mvlhke{position:relative;margin:0 auto;padding:40px 50px;min-height:230px;font-family:'Nanum Myeongjo',serif;font-size:1.8rem;line-height:1.8em;background:#fff;}@media (max-width:1170px){.css-mvlhke{padding:5vw 7vw 0;}}@media (max-width:800px){.css-mvlhke{font-size:1.4rem;}}.css-mvlhke:before{content:'';position:absolute;top:15px;left:-5px;z-index:-1;display:block;width:20px;height:200px;background:rgba(39,44,49,0.15);-webkit-filter:blur(5px);filter:blur(5px);-webkit-transform:rotate(-5deg);-ms-transform:rotate(-5deg);transform:rotate(-5deg);}.css-mvlhke:after{content:'';position:absolute;top:15px;right:-5px;z-index:-1;display:block;width:20px;height:200px;background:rgba(39,44,49,0.15);-webkit-filter:blur(5px);filter:blur(5px);-webkit-transform:rotate(5deg);-ms-transform:rotate(5deg);transform:rotate(5deg);}.css-mvlhke h1,.css-mvlhke h2,.css-mvlhke h3,.css-mvlhke h4,.css-mvlhke h5,.css-mvlhke h6,.css-mvlhke p,.css-mvlhke ul,.css-mvlhke ol,.css-mvlhke dl,.css-mvlhke pre,.css-mvlhke blockquote,.css-mvlhke .post-full-comments,.css-mvlhke .footnotes{min-width:100%;}.css-mvlhke li{word-break:break-word;}.css-mvlhke li p{margin:0.2em 0 0.1em 0;}.css-mvlhke a{color:#000;word-break:break-word;box-shadow:#3eb0ef 0 -1px 0 inset;}.css-mvlhke a:hover{color:#3eb0ef;-webkit-text-decoration:none;text-decoration:none;}.css-mvlhke strong,.css-mvlhke em{color:#0a0b0c;}.css-mvlhke small{display:inline-block;line-height:1.6em;}.css-mvlhke li:first-child{margin-top:0;}.css-mvlhke .gatsby-resp-image-link{box-shadow:none;}.css-mvlhke img,.css-mvlhke video{display:block;margin:1.5em auto;max-width:1040px;height:auto;}@media (max-width:1040px){.css-mvlhke img,.css-mvlhke video{width:100%;}}.css-mvlhke img[src$='#full']{max-width:none;width:100vw;}.css-mvlhke img + br + small{display:block;margin-top:-3em;margin-bottom:1.5em;text-align:center;}.css-mvlhke iframe{margin:0 auto !important;}.css-mvlhke blockquote{margin:0 0 1.5em;padding:0 1.5em;border-left:#3eb0ef 3px solid;}.css-mvlhke blockquote p{margin:0 0 1em 0;color:inherit;font-size:inherit;line-height:inherit;font-style:italic;}.css-mvlhke blockquote p:last-child{margin-bottom:0;}.css-mvlhke code{padding:0 5px 2px;font-size:0.8em;line-height:1em;font-weight:400 !important;background:#e5eff5;border-radius:3px;}.css-mvlhke p code{word-break:break-all;}.css-mvlhke pre{overflow-x:auto;padding:20px;max-width:100%;border:#131517 1px solid;color:#e5eff5;font-size:1.3rem;line-height:1.5em;background:#0e1012;border-radius:5px;}.css-mvlhke pre code{padding:0;font-size:inherit;line-height:inherit;background:transparent;}.css-mvlhke pre code:not(span){color:inherit;}.css-mvlhke .gatsby-resp-iframe-wrapper{margin:1.5em 0 3em;}.css-mvlhke hr{margin:4vw 0;}.css-mvlhke hr:after{content:'';position:absolute;top:-15px;left:50%;display:block;margin-left:-10px;width:1px;height:30px;background:#e4eaed;box-shadow:#fff 0 0 0 5px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);}.css-mvlhke h1,.css-mvlhke h2,.css-mvlhke h3,.css-mvlhke h4,.css-mvlhke h5,.css-mvlhke h6{color:#0b0c0e;font-family:'Nanum Myeongjo',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;}.css-mvlhke h1{margin:0.8em 0 0.6em 0;font-size:2.8rem;font-weight:700;}@media (max-width:500px){.css-mvlhke h1{font-size:2.2rem;}}.css-mvlhke h2{margin:0.6em 0 0.4em 0;font-size:2.4rem;font-weight:700;}@media (max-width:500px){.css-mvlhke h2{font-size:2rem;}}.css-mvlhke h3{margin:0.5em 0 0.2em 0;font-size:2rem;font-weight:700;}@media (max-width:500px){.css-mvlhke h3{font-size:1.8rem;}}.css-mvlhke h4{margin:0.5em 0 0.2em 0;font-size:1.8rem;font-weight:700;}@media (max-width:500px){.css-mvlhke h4{font-size:1.6rem;}}.css-mvlhke h5{display:block;margin:0.5em 0;padding:1em 0 1.5em;border:0;color:#3eb0ef;font-family:Georgia,serif;font-size:1.8rem;line-height:1.35em;text-align:center;}@media (min-width:1180px){.css-mvlhke h5{max-width:1060px;}}@media (max-width:500px){.css-mvlhke h5{padding:0 0 0.5em;font-size:1.5rem;}}.css-mvlhke h6{margin:0.5em 0 0.2em 0;font-size:1.8rem;font-weight:700;}@media (max-width:500px){.css-mvlhke h6{font-size:1.4rem;}}.css-mvlhke table{display:inline-block;overflow-x:auto;margin:0.5em 0 2.5em;max-width:100%;width:auto;border-spacing:0;border-collapse:collapse;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;font-size:1.4rem;white-space:nowrap;vertical-align:top;}.css-mvlhke table{-webkit-overflow-scrolling:touch;background:radial-gradient(ellipse at left,rgba(0,0,0,0.2) 0%,rgba(0,0,0,0) 75%) 0 center,radial-gradient(ellipse at right,rgba(0,0,0,0.2) 0%,rgba(0,0,0,0) 75%) 100% center;background-attachment:scroll,scroll;background-size:10px 100%,10px 100%;background-repeat:no-repeat;}.css-mvlhke table td:first-child{background-image:linear-gradient( to right,rgba(255,255,255,1) 50%,rgba(255,255,255,0) 100% );background-size:20px 100%;background-repeat:no-repeat;}.css-mvlhke table td:last-child{background-image:linear-gradient( to left,rgba(255,255,255,1) 50%,rgba(255,255,255,0) 100% );background-position:100% 0;background-size:20px 100%;background-repeat:no-repeat;}.css-mvlhke table th{color:#15171A;font-size:1.2rem;font-weight:700;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;text-align:left;text-transform:uppercase;background-color:#f4f8fb;}.css-mvlhke table th,.css-mvlhke table td{padding:6px 12px;border:#e9ebec 1px solid;}@media (max-width:500px){.css-mvlhke{padding:0;}.css-mvlhke:before{display:none;}.css-mvlhke:after{display:none;}}.css-mvlhke code[class*='language-'],.css-mvlhke pre[class*='language-']{background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;}.css-mvlhke pre[class*='language-']{overflow:auto;padding:1.3125rem;}.css-mvlhke pre[class*='language-']::-moz-selection{background:hsl(207,4%,16%);}.css-mvlhke pre[class*='language-']::selection{background:hsl(207,4%,16%);}.css-mvlhke pre[class*='language-']::-moz-selection,.css-mvlhke pre[class*='language-']::-moz-selection{text-shadow:none;background:hsla(0,0%,100%,0.15);}.css-mvlhke pre[class*='language-']::selection,.css-mvlhke pre[class*='language-']::selection{text-shadow:none;background:hsla(0,0%,100%,0.15);}.css-mvlhke:not(pre) > code[class*='language-']{border-radius:0.3em;background:var(--inlineCode-bg);color:var(--inlineCode-text);padding:0.15em 0.2em 0.05em;white-space:normal;}.css-mvlhke .token.attr-name{color:rgb(173,219,103);font-style:italic;}.css-mvlhke .token.comment{color:rgb(128,147,147);}.css-mvlhke .token.string,.css-mvlhke .token.url{color:rgb(173,219,103);}.css-mvlhke .token.variable{color:rgb(214,222,235);}.css-mvlhke .token.number{color:rgb(247,140,108);}.css-mvlhke .token.builtin,.css-mvlhke .token.char,.css-mvlhke .token.constant,.css-mvlhke .token.function{color:rgb(130,170,255);}.css-mvlhke .token.punctuation{color:rgb(199,146,234);}.css-mvlhke .token.selector,.css-mvlhke .token.doctype{color:rgb(199,146,234);font-style:'italic';}.css-mvlhke .token.class-name{color:rgb(255,203,139);}.css-mvlhke .token.tag,.css-mvlhke .token.operator,.css-mvlhke .token.keyword{color:#ffa7c4;}.css-mvlhke .token.boolean{color:rgb(255,88,116);}.css-mvlhke .token.property{color:rgb(128,203,196);}.css-mvlhke .token.namespace{color:rgb(178,204,214);}.css-mvlhke pre[data-line]{padding:1em 0 1em 3em;position:relative;}.css-mvlhke .gatsby-highlight-code-line{background-color:hsla(207,95%,15%,1);display:block;margin-right:-1.3125rem;margin-left:-1.3125rem;padding-right:1em;padding-left:1.25em;border-left:0.25em solid #ffa7c4;}.css-mvlhke .gatsby-highlight{margin-bottom:1.75rem;margin-left:-1.3125rem;margin-right:-1.3125rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto;}@media (max-width:672px){.css-mvlhke .gatsby-highlight{border-radius:0;}}.css-mvlhke .gatsby-highlight pre[class*='language-']{float:left;min-width:100%;}</style><section class="post-full-content css-mvlhke enbzra0"><div><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Dec  4 11:16:02 localhost kernel: Call Trace:
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff810d0361&gt;] ? cpuset_print_task_mems_allowed+0x91/0xb0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81122730&gt;] ? dump_header+0x90/0x1b0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff812282fc&gt;] ? security_real_capable_noaudit+0x3c/0x70
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81122bb2&gt;] ? oom_kill_process+0x82/0x2a0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81122af1&gt;] ? select_bad_process+0xe1/0x120
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81122ff0&gt;] ? out_of_memory+0x220/0x3c0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8112f90f&gt;] ? __alloc_pages_nodemask+0x89f/0x8d0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8116789a&gt;] ? alloc_pages_current+0xaa/0x110
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8111fb27&gt;] ? __page_cache_alloc+0x87/0x90
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8111f50e&gt;] ? find_get_page+0x1e/0xa0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81120ac7&gt;] ? filemap_fault+0x1a7/0x500
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81149e04&gt;] ? __do_fault+0x54/0x530
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8114a3d7&gt;] ? handle_pte_fault+0xf7/0xb00
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81528e4e&gt;] ? thread_return+0x4e/0x770
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff810a6d31&gt;] ? ktime_get_ts+0xb1/0xf0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81083e1c&gt;] ? lock_timer_base+0x3c/0x70
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8114b00a&gt;] ? handle_mm_fault+0x22a/0x300
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81084aa2&gt;] ? del_timer_sync+0x22/0x30
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8104a8d8&gt;] ? __do_page_fault+0x138/0x480
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff81061d00&gt;] ? default_wake_function+0x0/0x20
Dec  4 11:16:02 localhost kernel: [&lt;ffffffffa00b5938&gt;] ? jbd2_complete_transaction+0x68/0xb0 [jbd2]
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff811d6770&gt;] ? timeout_func+0x0/0x20
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8152e99e&gt;] ? do_page_fault+0x3e/0xa0
Dec  4 11:16:02 localhost kernel: [&lt;ffffffff8152bd55&gt;] ? page_fault+0x25/0x30</code></pre></div>
<p>해당 방법은 <a href="http://cafe.naver.com/opensourcesw/583">http://cafe.naver.com/opensourcesw/583</a> 에서 확인한 글입니다.</p>
<hr/>
<p>메모리관련 메커니즘을 수정해서 out of memory 를 줄이는 방법입니다.
Linux의 메모리 관리에서는 메모리 오버커밋이라는 메커니즘이 적용되어 있어 실제 메모리 이상의 공간을 확보할 수 있습니다.
이는 어떤 문제를 야기시킬 수 있는가 하면 Linux 가상 메모리 시스템은 프로세스가 메모리를 확보할 때는 많게 보이게 하고 실제로 프로세스가 메모리에 접근을 하게되면 실제 메모리를 할당하는데 이때 실제 메모리가 부족하게 되면 OS내부적으로 프로세스를 마음대로 kill을 해버리는데 이걸 OOM-killer(out of memory killer)라고 합니다.</p>
<p>OOM Killer는 시스템이 실제 메모리와 가상 메모리 공간(스왑)을 다 사용해, 필요한 메모리 공간을 새로 확보 할 수 없는 경우 프로세스를 종료시켜 여유메모리를 확보하는 리눅스 커널의 메커니즘 중에 하나입니다.
그래서 kill된 프로세스가 자기가 왜 죽어버리는지 알수 없는 인터럽트가 발생해서 자신이 인터럽트가 발생했을 때 예외처리를 수행하지 못하는 문제가 발생합니다.</p>
<p>이런현상이 데이터를 관리하는 DB서버에서 발생한다면 리눅스의 좋은 메커니즘이라도 고객의 인지 정보가 실제 데이터에는 저장되지 않는 데이터 유실을 유발시킬 수 있습니다. 그러므로 강제로 kill을 통한 메모리 확보가 아닌 DB자체가 메모리 부족을 인지하고 예외처리하는 로직을 태우게 OS환경을 만들어줄 필요가 있습니다.</p>
<p>관련 커널 매개변수 정보
<code class="language-text">vm.overcommit_memory</code>
0 : heuristic에 따라 overcommit 할 수 있고, 하지 않을 수도 있다.(default)
메모리 요구가 있을 때 여유공간이 없는 경우 실행중인 프로세스를 강제 종료 메모리를 억지로 확보함.
1 : 항상 overcommit 함. 메모리를 다 사용했는데도 충분한 메모리가 있는것처럼 처리됨. 그외에는 0과 같음.
무조건적으로 메모리 요청을 허용해주는 것으로서 OOM Killer가 가장 잘 발생될 수 있는 환경
2 : overcommit 하지 않음.
메모리가 부족할 경우 메모리 확보시 에러발생시킴 [Swap size] + ([RAM size} * vm.overcommit_ratio/100).
실제로 사용하지 않고 있다 하더라도 물리적인 메모리가 허용되는 한도에서만 메모리 할당 요청을 받아주는 형태.</p>
<p><code class="language-text">vm.overcommit_ratio</code>
사용 가능한 메모리의 백분율로 정의. overcommit_ratio의 디폴트는 50</p>
<p>centos command
/etc/sysctl.conf</p>
<p>vm.overcommit<em>memory = 2
vm.overcommit</em>ratio = 100</p>
<p>적용은 sysctl -p</p>
<hr/>
<p>여기까지 원글쓴이의 글이다.</p>
<p>만약 레이쇼를 적용하지 못한상태로 적용하게된다면…</p>
<p>bash 조차 먹히지 않는 상황이 발생할 수있다</p>
<p>그럴땐 원격으로 mysqladmin -h(호스트) -uroot -p shutdown 을 입력한다.</p>
<p>참고 kill 우선순위</p>
<p><a href="http://unix.stackexchange.com/a/128667">http://unix.stackexchange.com/a/128667</a></p></div></section></article><style data-emotion-css="zipe4b">.css-zipe4b{background-color:var(--whitegrey);margin-left:calc(50% - 50vw);margin-right:calc(50% - 50vw);}</style><aside role="navigation" class="css-zipe4b"><style data-emotion-css="1z9wln">.css-1z9wln{width:100%;}.css-1z9wln .inner{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:3em 2em;margin:0 auto;max-width:700px;}</style><div class="css-1z9wln e1ww6v4q0"><div class="inner"><style data-emotion-css="vcshp8">.css-vcshp8{-webkit-flex:1 1 300px;-ms-flex:1 1 300px;flex:1 1 300px;padding:0 2em;}.css-vcshp8 .label{font-family:'Avenir','Open Sans',sans-serif;margin:0;text-transform:uppercase;-webkit-letter-spacing:0.05em;-moz-letter-spacing:0.05em;-ms-letter-spacing:0.05em;letter-spacing:0.05em;font-size:1.2rem;color:rgba(0,0,0,0.28);font-weight:600;}.css-vcshp8 .label:last-child{text-align:right;}</style><div class="css-vcshp8 e1ww6v4q1"><a href="/2015-10-29-some-redis-error/" rel="prev"><p class="label">Previous</p><h3 class="article">REDIS 관련 에러</h3></a></div><div class="css-vcshp8 e1ww6v4q1"><a href="/2016-02-15-limit-in-each-databases/" rel="next"><p class="label">Next</p><h3 class="article">각 DB 에서 LIMIT 구현하기</h3></a></div></div></div></aside></main><style data-emotion-css="aztom8">.css-aztom8{padding:2rem 0;color:#8a8e99;font-size:1.5rem;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;}.css-aztom8 div,.css-aztom8 a{color:#8a8e99;font-family:'Avenir','Open Sans',serif;}</style><footer role="contentinfo" class="css-aztom8"><div>Copyright © 2019 <a href="https://monthlycode.dev">Monthly Code</a> • All rights reserved.</div></footer></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2015-12-04-out-of-memory-on-linux/";window.webpackCompilationHash="8a9853d4bfb9140402ff";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-d696c0e2c111e03cf16b.js"],"component---src-templates-index-tsx":["/component---src-templates-index-tsx-aab43f2b59ec48b9a387.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-69db3bf3742cbe76dea0.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-58a5f2ce12d0a71eb9f2.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-3d6e2c090bb378cd889d.js"]};/*]]>*/</script><script src="/webpack-runtime-03657e977ad153c2e41d.js" async=""></script><script src="/app-d696c0e2c111e03cf16b.js" async=""></script><script src="/0-d4ec043f7f8cf96fd5a5.js" async=""></script><script src="/component---src-templates-post-tsx-69db3bf3742cbe76dea0.js" async=""></script><script src="/1-0bf54a0d9660ab00f8dd.js" async=""></script></body></html>